From f88d2133a7ddbd7b8c1addac4fc4ec90d480629d Mon Sep 17 00:00:00 2001
From: Brian Robbins <brianrob@microsoft.com>
Date: Tue, 6 Mar 2018 02:51:22 -0800
Subject: [PATCH] Add tracepointprovider.cpp directly to PAL instead of to a
 separate tracepointprovider library. (#16771)

---
 src/dlls/mscoree/coreclr/CMakeLists.txt |  5 -----
 src/pal/src/CMakeLists.txt              | 10 +---------
 2 files changed, 1 insertion(+), 14 deletions(-)

diff --git a/src/dlls/mscoree/coreclr/CMakeLists.txt b/src/dlls/mscoree/coreclr/CMakeLists.txt
index 8043f77..fb5cc90 100644
--- a/src/dlls/mscoree/coreclr/CMakeLists.txt
+++ b/src/dlls/mscoree/coreclr/CMakeLists.txt
@@ -139,11 +139,6 @@ if(FEATURE_EVENT_TRACE)
             eventprovider # On Windows this library contains only macros
         )
     endif(CLR_CMAKE_PLATFORM_UNIX)
-    if(CLR_CMAKE_PLATFORM_LINUX)
-        list(APPEND CORECLR_LIBRARIES
-            tracepointprovider
-        )
-    endif(CLR_CMAKE_PLATFORM_LINUX)
 endif(FEATURE_EVENT_TRACE)
 
 target_link_libraries(coreclr ${CORECLR_LIBRARIES})
diff --git a/src/pal/src/CMakeLists.txt b/src/pal/src/CMakeLists.txt
index 0285d88..56df33f 100644
--- a/src/pal/src/CMakeLists.txt
+++ b/src/pal/src/CMakeLists.txt
@@ -179,6 +179,7 @@ set(SOURCES
   misc/strutil.cpp
   misc/sysinfo.cpp
   misc/time.cpp
+  misc/tracepointprovider.cpp
   misc/utils.cpp
   numa/numa.cpp
   objmgr/palobjbase.cpp
@@ -238,15 +239,6 @@ add_library(coreclrpal
   ${PLATFORM_SOURCES}
 )
 
-# This builds in functionality to load LTTng tracepoints at runtime
-# Needed when using LTTng to support event tracing on Linux
-if(CLR_CMAKE_PLATFORM_LINUX)
-    add_library(tracepointprovider
-      STATIC
-      misc/tracepointprovider.cpp
-    )
-endif(CLR_CMAKE_PLATFORM_LINUX)
-
 if(CMAKE_SYSTEM_NAME STREQUAL Darwin)
   find_library(COREFOUNDATION CoreFoundation)
   find_library(CORESERVICES CoreServices)
-- 
2.7.4

